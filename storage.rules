rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {

    // Rules for product images
    // This rule is intentionally simplified to allow any authenticated user to upload.
    // The overall security is maintained because only an admin (verified by Firestore rules)
    // can create a product document that links to this uploaded image.
    // An image uploaded by a non-admin will be orphaned and unused.
    match /products/{userId}/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
